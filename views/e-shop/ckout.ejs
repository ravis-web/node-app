<%- include('../includes/head.ejs') %>
<link rel="stylesheet" href="/styles/prod.css">
<link rel="stylesheet" href="/styles/ecart.css">

<style>
  .sponsor {
    text-align: right;
    margin-right: 1rem;
    font-size: 0.5rem;
  }
</style>

<%- include('../includes/navb.ejs') %>
<%- include('../includes/users.ejs') %>

<main>
  <div class="centered">
    <h3>Checkout</h3>
    <% if(products.length > 0) { %>
    <ul class="cart__item-list">
      <% products.forEach(product => { %>
      <li class="cart__item">
        <p><%= product.prodId.title %></p>
        <p>₹ <%= product.prodId.price %>/-</p>
        <p><%= product.quantity %></p>
        <p>₹ <%= product.quantity * product.prodId.price %>/-</p>
      </li>
      <% })%>
      <p id="api-k" style="display: none;"><%= api_k %></p>
      <p id="sessionId" style="display: none;"><%= sessionId %></p>
      <p class="sponsor">powered by Stripe</p>
      <h3>Total : ₹ <%= total %>/- </h3>
    </ul>

    <!-- Stripe : Paymenet -->
    <div class="centered">
      <button id="btn-order" class="btn">Checkout</button>
      <script src="https://js.stripe.com/v3/"></script>
      <script src="/scripts/stripe.js"></script>
    </div>

    <% } else { %>
    <div class="centered">
      <h5> No items here. </h5>
      <a href="/shop" class="btn"> Continue Shopping </a>
    </div>
    <% } %>
  </div>
</main>

<%- include('../includes/close.ejs') %>
